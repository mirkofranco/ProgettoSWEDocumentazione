stages:
  - "grammar"
  - name: "compile"
    if: (branch = develop) OR (branch = master)
  - name: "gulpease"
    if: (branch = develop) OR (branch = master)
before_install:
  - sudo apt-get update
  - sudo apt-get install hunspell
  - sudo apt-get install myspell-en-us
  - sudo apt-get install myspell-it
  - sudo apt-get install python-dev libxml2-dev libxslt1-dev antiword unrtf poppler-utils pstotext tesseract-ocr flac lame libmad0 libsox-fmt-mp3 sox libjpeg-dev swig libpulse-dev
  - pip install --user textract 
jobs:
  include:
    - stage: "grammar"
      script:
       - bash scripts/grammar.sh
    - stage: "compile"
      script:
        - sudo apt-get install -y --no-install-recommends texlive-full
        - cd Esterni/PianoDiProgetto
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error PianoDiProgetto.tex
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error PianoDiProgetto.tex
        - cd ../../
        - cd Esterni/PianoDiQualifica 
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error PianoDiQualifica.tex
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error PianoDiQualifica.tex
        - cd ../../
        - cd Esterni/AnalisiDeiRequisiti
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error AnalisiDeiRequisiti.tex
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error AnalisiDeiRequisiti.tex
        - cd ../../
        - cd Esterni/Glossario
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error Glossario.tex
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error Glossario.tex
        - cd ../../
        - cd Interni/NormeDiProgetto
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error NormeDiProgetto.tex
        - pdflatex -synctex=1 -interaction=nonstopmode -halt-on-error NormeDiProgetto.tex
        - cd ../../
    - stage: "gulpease"
      script:
       - cd Esterni/PianoDiProgetto
       - python scripts/gulpease.py PianoDiProgetto.pdf
       - cd ../../
       - cd Esterni/PianoDiQualifica
       - python scripts/gulpease.py PianoDiQualifica.pdf
       - cd ../../
       - cd Esterni/AnalisiDeiRequisiti
       - python scripts/gulpease.py PianoDiProgetto.pdf
       - cd ../../
notifications:
  slack: zerosevengroup:awH2p9uSzEPY9plMSyKBtAHF
